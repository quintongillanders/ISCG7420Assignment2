{"ast":null,"code":"const handleSubmit = async e => {\n  e.preventDefault();\n  setError('');\n  setIsLoading(true);\n  try {\n    // 1. Get the auth token\n    const response = await axios.post('http://localhost:8000/api-token-auth/', {\n      username,\n      password\n    });\n\n    // The token comes in the 'token' field, not 'access'\n    const token = response.data.token;\n    console.log('Token received:', token);\n\n    // 2. Set the token in localStorage and axios defaults\n    localStorage.setItem('access_token', token);\n    axios.defaults.headers.common['Authorization'] = `Token ${token}`;\n\n    // 3. Get user data\n    const userResponse = await axios.get('http://localhost:8000/api/users/me/');\n    console.log('User data:', userResponse.data);\n\n    // 4. Update auth context\n    login({\n      id: userResponse.data.id,\n      username: userResponse.data.username,\n      email: userResponse.data.email\n    }, userResponse.data.is_staff || false);\n\n    // 5. Redirect based on role\n    if (userResponse.data.is_staff) {\n      navigate('/admin');\n    } else {\n      navigate('/');\n    }\n  } catch (err) {\n    var _err$response, _err$response2, _err$response2$data, _err$response2$data$n;\n    console.error('Login error:', ((_err$response = err.response) === null || _err$response === void 0 ? void 0 : _err$response.data) || err);\n    setError(((_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : (_err$response2$data = _err$response2.data) === null || _err$response2$data === void 0 ? void 0 : (_err$response2$data$n = _err$response2$data.non_field_errors) === null || _err$response2$data$n === void 0 ? void 0 : _err$response2$data$n[0]) || 'Login failed. Please check your credentials and try again.');\n  } finally {\n    setIsLoading(false);\n  }\n};","map":{"version":3,"names":["handleSubmit","e","preventDefault","setError","setIsLoading","response","axios","post","username","password","token","data","console","log","localStorage","setItem","defaults","headers","common","userResponse","get","login","id","email","is_staff","navigate","err","_err$response","_err$response2","_err$response2$data","_err$response2$data$n","error","non_field_errors"],"sources":["C:/Users/GGPC/Desktop/GitUploads/ISCG7420Assignment2/conference-app/frontend/src/components/Login.js"],"sourcesContent":["const handleSubmit = async (e) => {\r\n  e.preventDefault();\r\n  setError('');\r\n  setIsLoading(true);\r\n\r\n  try {\r\n    // 1. Get the auth token\r\n    const response = await axios.post('http://localhost:8000/api-token-auth/', {\r\n      username,\r\n      password,\r\n    });\r\n\r\n    // The token comes in the 'token' field, not 'access'\r\n    const token = response.data.token;\r\n    console.log('Token received:', token);\r\n\r\n    // 2. Set the token in localStorage and axios defaults\r\n    localStorage.setItem('access_token', token);\r\n    axios.defaults.headers.common['Authorization'] = `Token ${token}`;\r\n\r\n    // 3. Get user data\r\n    const userResponse = await axios.get('http://localhost:8000/api/users/me/');\r\n    console.log('User data:', userResponse.data);\r\n\r\n    // 4. Update auth context\r\n    login(\r\n      {\r\n        id: userResponse.data.id,\r\n        username: userResponse.data.username,\r\n        email: userResponse.data.email,\r\n      },\r\n      userResponse.data.is_staff || false\r\n    );\r\n\r\n    // 5. Redirect based on role\r\n    if (userResponse.data.is_staff) {\r\n      navigate('/admin');\r\n    } else {\r\n      navigate('/');\r\n    }\r\n\r\n  } catch (err) {\r\n    console.error('Login error:', err.response?.data || err);\r\n    setError(err.response?.data?.non_field_errors?.[0] || 'Login failed. Please check your credentials and try again.');\r\n  } finally {\r\n    setIsLoading(false);\r\n  }\r\n};"],"mappings":"AAAA,MAAMA,YAAY,GAAG,MAAOC,CAAC,IAAK;EAChCA,CAAC,CAACC,cAAc,CAAC,CAAC;EAClBC,QAAQ,CAAC,EAAE,CAAC;EACZC,YAAY,CAAC,IAAI,CAAC;EAElB,IAAI;IACF;IACA,MAAMC,QAAQ,GAAG,MAAMC,KAAK,CAACC,IAAI,CAAC,uCAAuC,EAAE;MACzEC,QAAQ;MACRC;IACF,CAAC,CAAC;;IAEF;IACA,MAAMC,KAAK,GAAGL,QAAQ,CAACM,IAAI,CAACD,KAAK;IACjCE,OAAO,CAACC,GAAG,CAAC,iBAAiB,EAAEH,KAAK,CAAC;;IAErC;IACAI,YAAY,CAACC,OAAO,CAAC,cAAc,EAAEL,KAAK,CAAC;IAC3CJ,KAAK,CAACU,QAAQ,CAACC,OAAO,CAACC,MAAM,CAAC,eAAe,CAAC,GAAG,SAASR,KAAK,EAAE;;IAEjE;IACA,MAAMS,YAAY,GAAG,MAAMb,KAAK,CAACc,GAAG,CAAC,qCAAqC,CAAC;IAC3ER,OAAO,CAACC,GAAG,CAAC,YAAY,EAAEM,YAAY,CAACR,IAAI,CAAC;;IAE5C;IACAU,KAAK,CACH;MACEC,EAAE,EAAEH,YAAY,CAACR,IAAI,CAACW,EAAE;MACxBd,QAAQ,EAAEW,YAAY,CAACR,IAAI,CAACH,QAAQ;MACpCe,KAAK,EAAEJ,YAAY,CAACR,IAAI,CAACY;IAC3B,CAAC,EACDJ,YAAY,CAACR,IAAI,CAACa,QAAQ,IAAI,KAChC,CAAC;;IAED;IACA,IAAIL,YAAY,CAACR,IAAI,CAACa,QAAQ,EAAE;MAC9BC,QAAQ,CAAC,QAAQ,CAAC;IACpB,CAAC,MAAM;MACLA,QAAQ,CAAC,GAAG,CAAC;IACf;EAEF,CAAC,CAAC,OAAOC,GAAG,EAAE;IAAA,IAAAC,aAAA,EAAAC,cAAA,EAAAC,mBAAA,EAAAC,qBAAA;IACZlB,OAAO,CAACmB,KAAK,CAAC,cAAc,EAAE,EAAAJ,aAAA,GAAAD,GAAG,CAACrB,QAAQ,cAAAsB,aAAA,uBAAZA,aAAA,CAAchB,IAAI,KAAIe,GAAG,CAAC;IACxDvB,QAAQ,CAAC,EAAAyB,cAAA,GAAAF,GAAG,CAACrB,QAAQ,cAAAuB,cAAA,wBAAAC,mBAAA,GAAZD,cAAA,CAAcjB,IAAI,cAAAkB,mBAAA,wBAAAC,qBAAA,GAAlBD,mBAAA,CAAoBG,gBAAgB,cAAAF,qBAAA,uBAApCA,qBAAA,CAAuC,CAAC,CAAC,KAAI,4DAA4D,CAAC;EACrH,CAAC,SAAS;IACR1B,YAAY,CAAC,KAAK,CAAC;EACrB;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}